<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="http://rawgithub.com/joequery/Stupid-Table-Plugin/master/stupidtable.min.js"></script>

    <script>
      $(document).ready(function() {
        var es = new EventSource("/enum_server");
        var index = 0;
        es.onmessage = function (e) {
            // $("#log").append(e.data);
            var data = JSON.parse(e.data);
            var row = $('<tr></tr>');

            [
              ++index,
              data['server_name'],
              data['map_name'],
              data['game_name'],
              data['bots_no'],
              data['players_no']+ '/' + data['max_players'],
              data['has_vac']==1 ? 'âœ“' : '',
              data['has_password']==1 ? 'ðŸ”’' : '',
            ].forEach(function (td){
              $('<td></td>').text(td).appendTo(row)
            })
            row.append('<td><a href="steam://connect/'+ data['ip'] + ':' + data['port'] + '/">' + data['ip'] + ':' + data['port'] +'</a></td>')
            row.append('<td>'+ parseInt(data['rtt']*1000) + 'ms</td> ')
            $('table#result > tbody:last').append(row)
        };
      })
    </script>
  </head>
  <body>
    <div id="log" style="font-family: courier; font-size: 0.75em;"></div>
    <table id="result">
      <thead>
        <td>#</td>
        <td>server name</td>
        <td>map</td>
        <td>game</td>
        <td>bots</td>
        <td>players</td>
        <td>VAC</td>
        <td>pwd</td>
        <td>ip:port</td>
        <td>rtt</td>
      </thead>
      <tbody></tbody>
    </table>
  </body>
</html>